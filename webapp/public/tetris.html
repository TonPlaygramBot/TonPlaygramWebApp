<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Tetris Classic</title>
  <style>
    :root { color-scheme: dark; }
    body{margin:0;background:#070b14;color:#fff;font-family:system-ui;display:flex;flex-direction:column;align-items:center;min-height:100vh;}
    h1{font-size:20px;margin:14px 0 8px}
    #hud{display:flex;gap:14px;font-size:14px;margin-bottom:8px}
    canvas{background:#0f1628;border:2px solid #3b82f6;border-radius:12px;touch-action:none}
    .controls{margin:10px 0 18px;display:grid;grid-template-columns:56px 56px 56px;gap:8px;justify-items:center}
    button{width:56px;height:48px;border-radius:10px;border:1px solid #3b82f6;background:#1e293b;color:#fff;font-size:20px}
    .wide{grid-column:1/4;width:176px}
  </style>
</head>
<body>
  <h1>Tetris Classic</h1>
  <div id="hud"><div>Score: <span id="score">0</span></div><div>Lines: <span id="lines">0</span></div></div>
  <canvas id="game" width="240" height="480" aria-label="Tetris board"></canvas>
  <div class="controls">
    <button id="left">◀</button><button id="rotate">⟳</button><button id="right">▶</button>
    <button id="down" class="wide">▼ Drop</button>
  </div>
<script>
const COLS=10, ROWS=20, SIZE=24;
const COLORS=['#000','#38bdf8','#f59e0b','#a3e635','#f472b6','#fb7185','#34d399','#facc15'];
const SHAPES=[[],[[1,1,1,1]],[[2,2],[2,2]],[[0,3,0],[3,3,3]],[[4,4,0],[0,4,4]],[[0,5,5],[5,5,0]],[[6,0,0],[6,6,6]],[[0,0,7],[7,7,7]]];
const canvas=document.getElementById('game'); const ctx=canvas.getContext('2d');
const board=Array.from({length:ROWS},()=>Array(COLS).fill(0));
let piece,newPiece,score=0,lines=0,dropMs=600,last=0,gameOver=false;
function rndPiece(){const id=(Math.random()*7|0)+1; return {x:3,y:0,id,shape:SHAPES[id].map(r=>r.slice())};}
function rotate(shape){return shape[0].map((_,i)=>shape.map(r=>r[i]).reverse());}
function collide(p){for(let y=0;y<p.shape.length;y++)for(let x=0;x<p.shape[y].length;x++)if(p.shape[y][x]){const nx=p.x+x,ny=p.y+y; if(nx<0||nx>=COLS||ny>=ROWS||(ny>=0&&board[ny][nx]))return true;}return false;}
function merge(p){p.shape.forEach((row,y)=>row.forEach((v,x)=>{if(v&&p.y+y>=0)board[p.y+y][p.x+x]=v;}));}
function clearLines(){let c=0; for(let y=ROWS-1;y>=0;y--){if(board[y].every(v=>v)){board.splice(y,1);board.unshift(Array(COLS).fill(0));c++;y++;}} if(c){lines+=c;score+=c*c*100;dropMs=Math.max(120,600-lines*8);} }
function spawn(){piece=newPiece||rndPiece(); newPiece=rndPiece(); if(collide(piece)) gameOver=true;}
function move(dx,dy){if(gameOver) return; piece.x+=dx; piece.y+=dy; if(collide(piece)){piece.x-=dx; piece.y-=dy; if(dy){merge(piece);clearLines();spawn();} }}
function hardDrop(){while(!collide({...piece,y:piece.y+1}))piece.y++; move(0,1);}
function doRotate(){const s=rotate(piece.shape); const old=piece.shape; piece.shape=s; if(collide(piece)) piece.shape=old;}
function drawCell(x,y,v){ctx.fillStyle=COLORS[v]; ctx.fillRect(x*SIZE+1,y*SIZE+1,SIZE-2,SIZE-2);} 
function draw(){ctx.clearRect(0,0,canvas.width,canvas.height); for(let y=0;y<ROWS;y++)for(let x=0;x<COLS;x++)if(board[y][x])drawCell(x,y,board[y][x]); if(!gameOver) piece.shape.forEach((r,y)=>r.forEach((v,x)=>v&&drawCell(piece.x+x,piece.y+y,v))); document.getElementById('score').textContent=score; document.getElementById('lines').textContent=lines; if(gameOver){ctx.fillStyle='rgba(0,0,0,.7)';ctx.fillRect(0,0,canvas.width,canvas.height);ctx.fillStyle='#fff';ctx.font='24px system-ui';ctx.fillText('Game Over',55,230);} }
function loop(ts){if(!last)last=ts; if(!gameOver && ts-last>dropMs){move(0,1);last=ts;} draw(); requestAnimationFrame(loop);} 
window.addEventListener('keydown',e=>{if(e.key==='ArrowLeft')move(-1,0);if(e.key==='ArrowRight')move(1,0);if(e.key==='ArrowDown')move(0,1);if(e.key==='ArrowUp')doRotate();if(e.key===' ')hardDrop();});
left.onclick=()=>move(-1,0); right.onclick=()=>move(1,0); down.onclick=()=>move(0,1); rotate.onclick=()=>doRotate();
spawn(); requestAnimationFrame(loop);
</script>
</body></html>
